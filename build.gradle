/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn more about Gradle by exploring our Samples at https://docs.gradle.org/8.14/samples
 * This project uses @Incubating APIs which are subject to change.
 */

plugins {
    id 'java'
}

repositories {
    mavenCentral()
}

dependencies {
    testImplementation platform('io.cucumber:cucumber-bom:7.15.0')
    testImplementation platform('org.junit:junit-bom:5.9.3')
    
    testImplementation 'io.cucumber:cucumber-java'
    testImplementation 'io.cucumber:cucumber-junit-platform-engine'
    testImplementation 'io.cucumber:cucumber-picocontainer'
    testImplementation 'io.rest-assured:rest-assured:5.3.2'
    testImplementation 'io.rest-assured:json-path:5.3.2'
    testImplementation 'io.rest-assured:xml-path:5.3.2'
    testImplementation 'org.junit.platform:junit-platform-suite'
    testImplementation 'org.junit.jupiter:junit-jupiter'
    testImplementation 'org.junit.platform:junit-platform-suite-api'
    
    // TestNG
    testImplementation 'org.testng:testng:7.8.0'
    
    // Web UI dependencies
    implementation 'org.seleniumhq.selenium:selenium-java:4.21.0'
    implementation 'io.github.bonigarcia:webdrivermanager:5.4.1'
}

test {
    useJUnitPlatform()
    
    testLogging {
        events = ["passed", "failed", "skipped"]
        showStandardStreams = true
        exceptionFormat = "full"
    }
    
    systemProperties = [
        'cucumber.plugin': 'pretty,html:build/reports/cucumber.html,json:build/reports/cucumber.json',
        'cucumber.glue': 'api,web',
        'cucumber.features': 'src/test/resources/features',
        'cucumber.filter.tags': System.getProperty('cucumber.filter.tags', '@api or @web')
    ]
    
    outputs.upToDateWhen { false }
    finalizedBy 'cucumberReports'
}

task cucumberReports {
    doLast {
        println "Cucumber reports generated at:"
        println "- HTML: build/reports/cucumber.html"
        println "- JSON: build/reports/cucumber.json"
    }
}

